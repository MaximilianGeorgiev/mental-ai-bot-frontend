<div>
  <div>
    <h1 mat-dialog-title>Create self care plan</h1>
    <div mat-dialog-content>
      <p>
        A self care plan will be generated by prioritizing the activities you find interesting. You will receive daily goals to achieve for the activities and you will be able to
        track your progress daily.
      </p>
      <p *ngIf="!activitiesNotSpecified">Your prefered tasks are:</p>
      <p *ngIf="activitiesNotSpecified">
        You have not specified any prefered activities and a random program will be created for you. If you wish, you can edit your profile and add your interests to your profile.
      </p>
      <mat-form-field>
        <mat-label>End date</mat-label>
        <input matInput [matDatepicker]="picker" [(ngModel)]="endDate" [formControl]="endDateFormControl" />
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        @if (endDateFormControl.hasError('required')) {
        <mat-error>This field is required</mat-error>
        }
      </mat-form-field>

      <mat-form-field>
        <mat-label>Intensity</mat-label>
        <mat-select [formControl]="intensityFormControl" [(ngModel)]="intensity">
          @for (intensityLevel of taskIntensityOptions; track intensityLevel) {
          <mat-option [value]="intensityLevel.value">{{ intensityLevel.displayValue }}</mat-option>
          }
        </mat-select>
        @if (intensityFormControl.hasError('required')) {
        <mat-error>This field is required</mat-error>
        }
      </mat-form-field>

      <div *ngIf="activitiesGenerated.length > 0">
        <p>You can discard and regenerate the plan or approve it. The generated activities are:</p>
        <ul *ngFor="let activity of activitiesGenerated">
          <li>Activity: {{ activity!.activity }}</li>
          <li>Description: {{ activity!.description }}</li>
          <li>Daily progress: {{ activity!.metricQuantity }} {{ activity!.metric }}</li>
        </ul>
        <button mat-icon-button aria-label="Discard" (click)="generateSelfCarePlanActivities(true)">
          <mat-icon svgIcon="discard">Discard</mat-icon>
        </button>
        <button mat-icon-button aria-label="Approve" (click)="generateSelfCarePlan()">
          <mat-icon svgIcon="approve">Approve</mat-icon>
        </button>
      </div>

      <div mat-dialog-actions>
        <button mat-button mat-dialog-close>Close</button>
        <button *ngIf="activitiesGenerated.length === 0" mat-button cdkFocusInitial (click)="generateSelfCarePlanActivities()">Generate</button>
      </div>
    </div>
  </div>
</div>
